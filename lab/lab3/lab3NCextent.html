<head>
  <title>Lab3: Web-based Mapping Using OpenLayers</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v10.6.1/ol.css" />
  <script src="https://cdn.jsdelivr.net/npm/ol@v10.6.1/dist/ol.js"></script>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol-layerswitcher@4.1.2/dist/ol-layerswitcher.css" />
  <script src="https://cdn.jsdelivr.net/npm/ol-layerswitcher@4.1.2/dist/ol-layerswitcher.js"></script>

  <style>
    #map {
      width: 800px;
      height: 600px;
    }
  </style>
</head>
<body>
  <h3>Lab3: Web-based Mapping Using OpenLayers</h3>
  <h4>Author: Emerson Wright</h4>
  <div id="map"></div>

  <script>
    const ncExtent4326 = [-84.3219, 33.8423, -75.4001, 36.5880];
    const ncExtent3857 = ol.proj.transformExtent(ncExtent4326, 'EPSG:4326', 'EPSG:3857');

    const AZURE_KEY =
      '81u9AnyuE91GBupq2rrMNIytJcQQ6dExViU2bLHif4cC9VSKQpuIJQQJ99BJACYeBjFNMnj2AAAgAZMP4Q3s';

  
    const azureRoad = new ol.layer.Tile({
      title: 'Azure Maps (Terra)',
      type: 'base',
      visible: true,
      source: new ol.source.XYZ({
        url:
          'https://atlas.microsoft.com/map/tile?api-version=2022-08-01' +
          '&tilesetId=microsoft.base.road&zoom={z}&x={x}&y={y}' +
          '&subscription-key=' + AZURE_KEY,
        crossOrigin: 'anonymous'
      })
    });

    const osm = new ol.layer.Tile({
      title: 'OpenStreetMap',
      type: 'base',
      visible: false,
      source: new ol.source.OSM()
    });

    const baseGroup = new ol.layer.Group({
      title: 'Base maps',
      layers: [azureRoad, osm]
    });

    const wms = new ol.layer.Tile({
      title: 'States (WMS)',
      visible: true,
      source: new ol.source.TileWMS({
        url: 'https://ahocevar.com/geoserver/wms',
        params: {
          'LAYERS': 'topp:states',
          'TILED': true,
          'FORMAT': 'image/png',
          'TRANSPARENT': true
        },
        serverType: 'geoserver',
        transition: 0
      })
    });

    const map = new ol.Map({
      target: 'map',
      layers: [baseGroup, wms],
      view: new ol.View({
        projection: 'EPSG:3857',
        center: ol.proj.fromLonLat([-79.0, 35.5]),
        zoom: 7
      })
    });

    map.getView().fit(ncExtent3857, {
      size: map.getSize(),
      padding: [20, 20, 20, 20],
      duration: 300
    });

    const layerSwitcher = new ol.control.LayerSwitcher({
      tipLabel: 'Legend',
      activationMode: 'click',
      startActive: false
    });
    map.addControl(layerSwitcher);
  </script>
</body>
</html>
